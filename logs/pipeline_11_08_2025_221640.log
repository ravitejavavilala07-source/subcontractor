2025-11-08 22:16:40,261 - INFO - ================================================================================
2025-11-08 22:16:40,261 - INFO - ENHANCED RECONCILIATION PIPELINE - MAY 2025
2025-11-08 22:16:40,261 - INFO - ================================================================================
2025-11-08 22:16:40,261 - INFO - 
[STEP 1/4] Loading input files...
2025-11-08 22:16:40,261 - INFO - ================================================================================
2025-11-08 22:16:40,261 - INFO - LOADING ALL MAY 2025 INPUT FILES
2025-11-08 22:16:40,261 - INFO - ================================================================================
2025-11-08 22:16:40,261 - INFO - Loading Pivot Table...
2025-11-08 22:16:52,692 - INFO - ✅ Loaded 113,393 records from Pivot Table
2025-11-08 22:16:52,692 - INFO - Loading Accrual Workbook...
2025-11-08 22:16:53,660 - INFO - ✅ Loaded Accrual data:
2025-11-08 22:16:53,660 - INFO -    - Accrual: 37 consultants
2025-11-08 22:16:53,660 - INFO -    - Tracker: 110 transactions
2025-11-08 22:16:53,660 - INFO -    - YTD Billing: 2,637 records
2025-11-08 22:16:53,660 - INFO - ================================================================================
2025-11-08 22:16:53,660 - INFO - ✅ ALL FILES LOADED SUCCESSFULLY
2025-11-08 22:16:53,660 - INFO - ================================================================================
2025-11-08 22:16:53,660 - INFO - 
[STEP 2/4] Loading vendor mappings...
2025-11-08 22:16:53,660 - INFO - Creating master consultant list...
2025-11-08 22:16:53,676 - INFO - ✅ Master list created: 931 unique consultants
2025-11-08 22:16:53,676 - INFO - Validating mapping quality...
2025-11-08 22:16:53,676 - ERROR - ❌ Pipeline failed: 'exception_flag'
Traceback (most recent call last):
  File "/Users/ravitejavavilala/smartworks_accrual/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3653, in get_loc
    return self._engine.get_loc(casted_key)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "pandas/_libs/index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas/_libs/hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas/_libs/hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: 'exception_flag'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/Users/ravitejavavilala/smartworks_accrual/subcontractor/scripts/run_pipeline_v2.py", line 48, in run_pipeline
    mapping_validation = mapper.validate_mapping(data['pivot'])
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ravitejavavilala/smartworks_accrual/subcontractor/scripts/vendor_mapper.py", line 100, in validate_mapping
    matched_records = len(reconciled_df[reconciled_df['exception_flag'] == ''])
                                        ~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
  File "/Users/ravitejavavilala/smartworks_accrual/venv/lib/python3.11/site-packages/pandas/core/frame.py", line 3761, in __getitem__
    indexer = self.columns.get_loc(key)
              ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/ravitejavavilala/smartworks_accrual/venv/lib/python3.11/site-packages/pandas/core/indexes/base.py", line 3655, in get_loc
    raise KeyError(key) from err
KeyError: 'exception_flag'
