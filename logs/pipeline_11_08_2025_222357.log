2025-11-08 22:23:57,428 - INFO - ================================================================================
2025-11-08 22:23:57,428 - INFO - FINAL RECONCILIATION PIPELINE - MAY 2025
2025-11-08 22:23:57,428 - INFO - ================================================================================
2025-11-08 22:23:57,428 - INFO - 
[STEP 1/3] Loading input files...
2025-11-08 22:23:57,428 - INFO - ================================================================================
2025-11-08 22:23:57,428 - INFO - LOADING ALL MAY 2025 INPUT FILES
2025-11-08 22:23:57,428 - INFO - ================================================================================
2025-11-08 22:23:57,429 - INFO - Loading Pivot Table...
2025-11-08 22:24:10,112 - INFO - ✅ Loaded 113,393 records from Pivot Table
2025-11-08 22:24:10,112 - INFO - Loading Accrual Workbook...
2025-11-08 22:24:11,112 - INFO - ✅ Loaded Accrual data:
2025-11-08 22:24:11,113 - INFO -    - Accrual: 37 consultants
2025-11-08 22:24:11,113 - INFO -    - Tracker: 110 transactions
2025-11-08 22:24:11,113 - INFO -    - YTD Billing: 2,637 records
2025-11-08 22:24:11,113 - INFO - ================================================================================
2025-11-08 22:24:11,113 - INFO - ✅ ALL FILES LOADED SUCCESSFULLY
2025-11-08 22:24:11,113 - INFO - ================================================================================
2025-11-08 22:24:11,113 - INFO - ✅ Pivot: 113,393 records
2025-11-08 22:24:11,113 - INFO - ✅ Accrual: 37 records
2025-11-08 22:24:11,113 - INFO - 
[STEP 2/3] Reconciling...
2025-11-08 22:24:11,113 - INFO - Starting final reconciliation...
2025-11-08 22:24:11,113 - INFO - Pivot columns: ['Customer_BillToNumber', 'vendor_company', 'CUST_ID', 'customer_name', 'invoice_number', 'invoice_date', 'hours_billed', 'bill_rate', 'amount_billed', 'service_month', 'Period_StartDate', 'period_end', 'CUST_CITY', 'CUST_STATE', 'Record_Status', 'Pay_Code', 'LOB', 'applicant_number', 'consultant_name', 'Job_WC_Code', 'TaxCodeAmount_Detail', 'Assignment_Id', 'Job_State', 'Pay_Rate', 'Equlv_Hrs_Rate']
2025-11-08 22:24:11,113 - INFO - Accrual columns: ['consultant_name', 'applicant_number', '12/31/2024 Accrued Payroll per Audit', 'Corrections & Adjustments to C/F', 'Accrued Beginning @ 01/01/2024', 'ytd_hours_invoiced', 'Year-to-Date Hrs-ALT', 'Reconciled DIFF', 'Other    DIFF', 'Year-to-Date Billed-ALT', 'Reconciled DIFF.1', 'Client  Discount Diff', 'ytd_amount_invoiced', 'YTD Extra Earnings', 'Notes', 'Less: YTD Reductions for Per Diem Expenses ', 'Less: YTD Reductions for Other Items ', ' Calculated YTD Net Accrual', 'ytd_amount_paid', 'Transfers In (Out)', 'Other Misc.', 'Accrual Balance Write-off (NLE)', 'NOTES', datetime.datetime(2025, 12, 31, 0, 0), 'Accrued Number Keyed (OWE)', 'Diff Between Calculation and Keyed Number', '\xa0Amount Due at 12/07/2018', 'Unnamed: 27', 'LOB    Unallocated', 'LOB     11/12/13', 'LOB            21/22', 'LOB            31/32', 'Unnamed: 32', 'Amount Due at 12/07/18 w/o negative', 'Unnamed: 34', 'Notes.1', 'Classification']
2025-11-08 22:24:11,148 - INFO - ✅ Pivot aggregated: 876 consultants
2025-11-08 22:24:11,148 - INFO - ✅ Accrual prepared: 37 consultants
2025-11-08 22:24:11,152 - INFO - ✅ Merged: 876 records
2025-11-08 22:24:11,159 - INFO - ✅ Reconciliation complete: 876 records
2025-11-08 22:24:11,159 - INFO - ✅ Found 876 exceptions
2025-11-08 22:24:11,161 - INFO - ✅ Created vendor summary
2025-11-08 22:24:11,161 - INFO - 
================================================================================
2025-11-08 22:24:11,161 - INFO - QA METRICS REPORT
2025-11-08 22:24:11,161 - INFO - ================================================================================
2025-11-08 22:24:11,161 - INFO - total_records........................... 876
2025-11-08 22:24:11,161 - INFO - matched_records......................... 0
2025-11-08 22:24:11,161 - INFO - exception_records....................... 876
2025-11-08 22:24:11,161 - INFO - match_rate_pct.......................... 0.0%
2025-11-08 22:24:11,161 - INFO - missing_invoices........................ 845
2025-11-08 22:24:11,161 - INFO - short_pays.............................. 16
2025-11-08 22:24:11,161 - INFO - overpayments............................ 0
2025-11-08 22:24:11,161 - INFO - data_quality............................ WARNING
2025-11-08 22:24:11,161 - INFO - ================================================================================

2025-11-08 22:24:11,161 - INFO - 
[STEP 3/3] Generating report...
2025-11-08 22:24:11,161 - INFO - Generating report: Subcontractor_Accrual_Reconciliation_11.08.2025.xlsx
2025-11-08 22:24:11,161 - INFO - Performing data validation...
2025-11-08 22:24:11,163 - INFO - Validation Results:
2025-11-08 22:24:11,163 - INFO -   Null values in applicant_number: ✅ PASS
2025-11-08 22:24:11,163 - INFO -   Null values in hours_billed: ✅ PASS
2025-11-08 22:24:11,163 - INFO -   Null values in amount_billed: ✅ PASS
2025-11-08 22:24:11,163 - INFO -   Exception categorization: ✅ PASS
2025-11-08 22:24:11,163 - INFO -   Variance calculation (hours_variance): ✅ PASS
2025-11-08 22:24:11,163 - INFO -   Variance calculation (amount_variance): ✅ PASS
2025-11-08 22:24:11,163 - INFO -   Duplicate applicant numbers: ✅ PASS
2025-11-08 22:24:11,215 - INFO - ✅ Sheet 1: Reconciled Data (876 rows)
2025-11-08 22:24:11,256 - INFO - ✅ Sheet 2: Exceptions Only (876 rows)
2025-11-08 22:24:11,278 - INFO - ✅ Sheet 3: Vendor Summary (343 vendors)
2025-11-08 22:24:11,279 - INFO - ✅ Sheet 4: QA Summary
2025-11-08 22:24:11,280 - INFO - ✅ Sheet 5: Data Validation Report
2025-11-08 22:24:11,430 - INFO - ✅ Report saved to: data/output/may_2025/Subcontractor_Accrual_Reconciliation_11.08.2025.xlsx
2025-11-08 22:24:11,430 - INFO - 
================================================================================
2025-11-08 22:24:11,430 - INFO - ✅ PIPELINE COMPLETE - SUCCESS!
2025-11-08 22:24:11,430 - INFO - Report: data/output/may_2025/Subcontractor_Accrual_Reconciliation_11.08.2025.xlsx
2025-11-08 22:24:11,430 - INFO - ================================================================================
